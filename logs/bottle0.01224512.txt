Training: 0it [00:00, ?it/s]Training:   0%|          | 0/7 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/7 [00:00<?, ?it/s] Epoch 0:  14%|█▍        | 1/7 [00:16<01:37, 16.23s/it]Epoch 0:  14%|█▍        | 1/7 [00:16<01:37, 16.23s/it, loss=nan, v_num=0]Epoch 0:  29%|██▊       | 2/7 [00:25<01:04, 12.86s/it, loss=nan, v_num=0]Epoch 0:  29%|██▊       | 2/7 [00:25<01:04, 12.86s/it, loss=nan, v_num=0]Epoch 0:  43%|████▎     | 3/7 [00:35<00:47, 11.76s/it, loss=nan, v_num=0]Epoch 0:  43%|████▎     | 3/7 [00:35<00:47, 11.76s/it, loss=nan, v_num=0]Epoch 0:  57%|█████▋    | 4/7 [00:44<00:33, 11.23s/it, loss=nan, v_num=0]Epoch 0:  57%|█████▋    | 4/7 [00:44<00:33, 11.23s/it, loss=nan, v_num=0]Epoch 0:  71%|███████▏  | 5/7 [00:54<00:21, 10.91s/it, loss=nan, v_num=0]Epoch 0:  71%|███████▏  | 5/7 [00:54<00:21, 10.91s/it, loss=nan, v_num=0]Epoch 0:  86%|████████▌ | 6/7 [00:58<00:09,  9.76s/it, loss=nan, v_num=0]Epoch 0:  86%|████████▌ | 6/7 [00:58<00:09,  9.76s/it, loss=nan, v_num=0]Epoch 0: 100%|██████████| 7/7 [00:59<00:00,  8.45s/it, loss=nan, v_num=0]Epoch 0: 100%|██████████| 7/7 [00:59<00:00,  8.45s/it, loss=nan, v_num=0]Getting transformed features...
Calculating distances...
Maximum distance from cluster centers is 1.66
initial embedding size :  (163856, 1536)
final embedding size :  (1638, 1536)
Epoch 0: 100%|██████████| 7/7 [10:01<00:00, 85.98s/it, loss=nan, v_num=0]
Testing: 0it [00:00, ?it/s]Testing:   1%|          | 1/83 [00:02<03:59,  2.92s/it]Testing:   2%|▏         | 2/83 [00:03<01:59,  1.48s/it]Testing:   4%|▎         | 3/83 [00:03<01:22,  1.03s/it]Testing:   5%|▍         | 4/83 [00:04<01:03,  1.24it/s]Testing:   6%|▌         | 5/83 [00:04<00:52,  1.50it/s]Testing:   7%|▋         | 6/83 [00:05<00:46,  1.64it/s]Testing:   8%|▊         | 7/83 [00:05<00:45,  1.66it/s]Testing:  10%|▉         | 8/83 [00:06<00:39,  1.92it/s]Testing:  11%|█         | 9/83 [00:06<00:37,  1.98it/s]Testing:  12%|█▏        | 10/83 [00:07<00:38,  1.91it/s]Testing:  13%|█▎        | 11/83 [00:07<00:36,  1.98it/s]Testing:  14%|█▍        | 12/83 [00:08<00:34,  2.07it/s]Testing:  16%|█▌        | 13/83 [00:08<00:33,  2.08it/s]Testing:  17%|█▋        | 14/83 [00:09<00:33,  2.07it/s]Testing:  18%|█▊        | 15/83 [00:09<00:33,  2.04it/s]Testing:  19%|█▉        | 16/83 [00:09<00:29,  2.26it/s]Testing:  20%|██        | 17/83 [00:10<00:28,  2.32it/s]Testing:  22%|██▏       | 18/83 [00:10<00:29,  2.24it/s]Testing:  23%|██▎       | 19/83 [00:11<00:29,  2.14it/s]Testing:  24%|██▍       | 20/83 [00:11<00:31,  1.97it/s]Testing:  25%|██▌       | 21/83 [00:12<00:30,  2.01it/s]Testing:  27%|██▋       | 22/83 [00:12<00:32,  1.90it/s]Testing:  28%|██▊       | 23/83 [00:13<00:31,  1.93it/s]Testing:  29%|██▉       | 24/83 [00:13<00:29,  1.97it/s]Testing:  30%|███       | 25/83 [00:14<00:28,  2.02it/s]Testing:  31%|███▏      | 26/83 [00:14<00:26,  2.12it/s]Testing:  33%|███▎      | 27/83 [00:15<00:25,  2.18it/s]Testing:  34%|███▎      | 28/83 [00:15<00:25,  2.18it/s]Testing:  35%|███▍      | 29/83 [00:16<00:25,  2.12it/s]Testing:  36%|███▌      | 30/83 [00:16<00:24,  2.16it/s]Testing:  37%|███▋      | 31/83 [00:17<00:22,  2.30it/s]Testing:  39%|███▊      | 32/83 [00:17<00:21,  2.33it/s]Testing:  40%|███▉      | 33/83 [00:17<00:21,  2.33it/s]Testing:  41%|████      | 34/83 [00:18<00:21,  2.26it/s]Testing:  42%|████▏     | 35/83 [00:18<00:21,  2.27it/s]Testing:  43%|████▎     | 36/83 [00:19<00:21,  2.18it/s]Testing:  45%|████▍     | 37/83 [00:19<00:19,  2.34it/s]Testing:  46%|████▌     | 38/83 [00:20<00:18,  2.46it/s]Testing:  47%|████▋     | 39/83 [00:20<00:15,  2.76it/s]Testing:  48%|████▊     | 40/83 [00:20<00:14,  3.04it/s]Testing:  49%|████▉     | 41/83 [00:20<00:13,  3.05it/s]Testing:  51%|█████     | 42/83 [00:21<00:14,  2.82it/s]Testing:  52%|█████▏    | 43/83 [00:21<00:14,  2.76it/s]Testing:  53%|█████▎    | 44/83 [00:22<00:13,  2.83it/s]Testing:  54%|█████▍    | 45/83 [00:22<00:13,  2.85it/s]Testing:  55%|█████▌    | 46/83 [00:22<00:12,  2.89it/s]Testing:  57%|█████▋    | 47/83 [00:23<00:12,  2.82it/s]Testing:  58%|█████▊    | 48/83 [00:23<00:11,  2.97it/s]Testing:  59%|█████▉    | 49/83 [00:23<00:11,  2.86it/s]Testing:  60%|██████    | 50/83 [00:24<00:12,  2.68it/s]Testing:  61%|██████▏   | 51/83 [00:24<00:12,  2.59it/s]Testing:  63%|██████▎   | 52/83 [00:24<00:11,  2.70it/s]Testing:  64%|██████▍   | 53/83 [00:25<00:10,  2.84it/s]Testing:  65%|██████▌   | 54/83 [00:25<00:09,  3.04it/s]Testing:  66%|██████▋   | 55/83 [00:25<00:08,  3.17it/s]Testing:  67%|██████▋   | 56/83 [00:26<00:08,  3.28it/s]Testing:  69%|██████▊   | 57/83 [00:26<00:08,  3.20it/s]Testing:  70%|██████▉   | 58/83 [00:26<00:08,  2.90it/s]Testing:  71%|███████   | 59/83 [00:27<00:08,  2.88it/s]Testing:  72%|███████▏  | 60/83 [00:27<00:07,  2.89it/s]Testing:  73%|███████▎  | 61/83 [00:27<00:07,  2.80it/s]Testing:  75%|███████▍  | 62/83 [00:28<00:07,  3.00it/s]Testing:  76%|███████▌  | 63/83 [00:28<00:06,  2.94it/s]Testing:  77%|███████▋  | 64/83 [00:29<00:07,  2.54it/s]Testing:  78%|███████▊  | 65/83 [00:29<00:07,  2.43it/s]Testing:  80%|███████▉  | 66/83 [00:29<00:07,  2.40it/s]Testing:  81%|████████  | 67/83 [00:30<00:06,  2.39it/s]Testing:  82%|████████▏ | 68/83 [00:30<00:06,  2.32it/s]Testing:  83%|████████▎ | 69/83 [00:31<00:06,  2.13it/s]Testing:  84%|████████▍ | 70/83 [00:31<00:06,  2.02it/s]Testing:  86%|████████▌ | 71/83 [00:32<00:05,  2.08it/s]Testing:  87%|████████▋ | 72/83 [00:32<00:05,  2.20it/s]Testing:  88%|████████▊ | 73/83 [00:33<00:04,  2.33it/s]Testing:  89%|████████▉ | 74/83 [00:33<00:03,  2.33it/s]Testing:  90%|█████████ | 75/83 [00:34<00:03,  2.02it/s]Testing:  92%|█████████▏| 76/83 [00:34<00:03,  1.95it/s]Testing:  93%|█████████▎| 77/83 [00:35<00:03,  2.00it/s]Testing:  94%|█████████▍| 78/83 [00:35<00:02,  2.13it/s]Testing:  95%|█████████▌| 79/83 [00:36<00:01,  2.09it/s]Testing:  96%|█████████▋| 80/83 [00:36<00:01,  2.17it/s]Testing:  98%|█████████▊| 81/83 [00:36<00:00,  2.19it/s]Testing:  99%|█████████▉| 82/83 [00:37<00:00,  2.11it/s]Testing: 100%|██████████| 83/83 [00:38<00:00,  1.97it/s]Total pixel-level auc-roc score :
0.9658138575796694
Total image-level auc-roc score :
0.9984126984126984
test_epoch_end
Testing: 100%|██████████| 83/83 [00:47<00:00,  1.75it/s]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'img_auc': 0.9984126984126984, 'pixel_auc': 0.9658138575796694}
--------------------------------------------------------------------------------
